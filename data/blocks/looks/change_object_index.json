{
  "id": "change_object_index",
  "category": "looks",
  "name": "오브젝트 순서 바꾸기",
  "description": "오브젝트의 레이어 순서(z-index)를 현재 위치에서 지정한 만큼 앞이나 뒤로 이동시키는 블록입니다. 양수를 입력하면 앞쪽(위)으로, 음수를 입력하면 뒤쪽(아래)으로 이동합니다. 오브젝트들의 겹침 순서를 세밀하게 조절할 때 사용합니다.",

  "educational_context": {
    "learning_objectives": [
      "레이어와 깊이 개념 이해",
      "오브젝트 순서의 상대적 변경 방법 학습",
      "z-index를 통한 시각적 계층 구조 관리",
      "겹침 효과와 깊이감 표현 기법 습득",
      "동적 레이어 관리 시스템 구축"
    ],
    "key_concepts": [
      {
        "concept": "레이어 순서",
        "explanation": "오브젝트들이 화면에 그려지는 순서로, 뒤에서부터 앞으로 겹쳐서 표시됩니다."
      },
      {
        "concept": "상대적 이동",
        "explanation": "현재 순서를 기준으로 지정한 칸수만큼 앞이나 뒤로 이동하는 방식입니다."
      },
      {
        "concept": "z-index",
        "explanation": "3차원 공간에서 깊이를 나타내는 좌표로, 화면상의 겹침 순서를 결정합니다."
      },
      {
        "concept": "레이어 스택",
        "explanation": "오브젝트들이 쌓여있는 구조로, 위에 있을수록 앞에 표시됩니다."
      }
    ],
    "difficulty_level": "중급",
    "prerequisites": ["오브젝트 개념 이해", "레이어 기본 지식", "좌표계 이해", "기본 그래픽 조작 경험"]
  },

  "usage_examples": [
    {
      "title": "카드 게임 시스템",
      "description": "카드를 뽑고 정렬하는 레이어 관리",
      "blocks": [
        "when_run_button_click",
        "// 카드 초기 배치",
        "repeat_basic(5)",
        "  clone_self()",
        "  wait_second(0.1)",
        "",
        "when_clone_start",
        "set_variable('카드번호', <get_clone_number()>)",
        "move_xy(<calc_operation(<get_variable('카드번호')>, '*', 30)>, 0)",
        "// 각 카드를 순서대로 배치",
        "change_object_index(<get_variable('카드번호')>)",
        "",
        "when_object_click",
        "// 클릭한 카드를 맨 앞으로",
        "repeat_basic(10)",
        "  change_object_index(1)",
        "  wait_second(0.02)",
        "// 선택된 카드 표시",
        "change_y(30)",
        "wait_second(1)",
        "change_y(-30)",
        "",
        "when_some_key_pressed('s')",
        "// 카드 섞기 - 순서 무작위 변경",
        "repeat_basic(20)",
        "  change_object_index(<random_number(-5, 5)>)",
        "  wait_second(0.05)"
      ],
      "explanation": "카드의 레이어 순서를 동적으로 변경하여 카드 게임 효과를 구현합니다."
    },
    {
      "title": "깊이감 있는 파티클 효과",
      "description": "파티클의 크기에 따른 레이어 정렬",
      "blocks": [
        "when_run_button_click",
        "repeat_basic(20)",
        "  broadcast_message('파티클생성')",
        "  wait_second(0.1)",
        "",
        "when_message_cast('파티클생성')",
        "clone_self()",
        "",
        "when_clone_start",
        "// 크기별 레이어 설정",
        "set_variable('크기', <random_number(50, 150)>)",
        "set_size(<get_variable('크기')>)",
        "move_to_random_position()",
        "",
        "// 작은 것은 뒤로, 큰 것은 앞으로",
        "if_condition(<get_variable('크기') < 80>)",
        "  change_object_index(-10)",
        "  set_effect('brightness', -30)",
        "else_if(<get_variable('크기') > 120>)",
        "  change_object_index(10)",
        "  set_effect('brightness', 20)",
        "",
        "// 떨어지는 애니메이션",
        "repeat_while_true",
        "  change_y(-<calc_operation(<get_variable('크기')>, '/', 30)>)",
        "  if_condition(<coordinate_object('y') < -180>)",
        "    move_y(360)",
        "    // 위치 리셋 시 레이어도 재조정",
        "    change_object_index(<random_number(-3, 3)>)",
        "  wait_second(0.02)"
      ],
      "explanation": "파티클 크기에 따라 레이어를 조정하여 원근감을 표현합니다."
    },
    {
      "title": "UI 패널 관리",
      "description": "팝업 창과 메뉴의 레이어 제어",
      "blocks": [
        "// 메인 UI",
        "when_run_button_click",
        "set_variable('현재패널', '메인')",
        "",
        "when_message_cast('메뉴열기')",
        "show()",
        "// 메뉴를 점진적으로 앞으로",
        "repeat_basic(5)",
        "  change_object_index(2)",
        "  change_transparency(-10)",
        "  wait_second(0.05)",
        "set_variable('현재패널', '메뉴')",
        "",
        "when_message_cast('설정열기')",
        "show()",
        "// 설정창을 최상위로",
        "repeat_basic(10)",
        "  change_object_index(1)",
        "  wait_second(0.02)",
        "set_variable('현재패널', '설정')",
        "",
        "when_message_cast('닫기')",
        "// 현재 패널을 뒤로 보내고 숨기기",
        "repeat_basic(10)",
        "  change_object_index(-1)",
        "  change_transparency(10)",
        "  wait_second(0.02)",
        "hide()",
        "",
        "when_object_click",
        "// 클릭한 패널 활성화",
        "repeat_basic(5)",
        "  change_object_index(1)",
        "set_effect('brightness', 20)",
        "wait_second(0.5)",
        "set_effect('brightness', 0)"
      ],
      "explanation": "UI 요소들의 레이어를 관리하여 적절한 표시 순서를 유지합니다."
    },
    {
      "title": "3D 회전 효과",
      "description": "회전하는 오브젝트의 깊이 표현",
      "blocks": [
        "when_run_button_click",
        "set_variable('각도', 0)",
        "",
        "repeat_while_true",
        "  change_variable('각도', 5)",
        "  ",
        "  // 사인 함수로 앞뒤 이동 계산",
        "  set_variable('깊이', <calc_operation(<sin(<get_variable('각도')>)>, '*', 10)>)",
        "  ",
        "  // 깊이에 따른 레이어 조정",
        "  if_condition(<get_variable('깊이') > 0>)",
        "    change_object_index(1)",
        "    change_size(2)",
        "  else",
        "    change_object_index(-1)",
        "    change_size(-2)",
        "  ",
        "  // X 좌표도 함께 이동",
        "  set_x(<calc_operation(<cos(<get_variable('각도')>)>, '*', 100)>)",
        "  ",
        "  wait_second(0.05)"
      ],
      "explanation": "삼각함수를 이용해 3D 회전 효과와 깊이감을 구현합니다."
    },
    {
      "title": "동적 정렬 시스템",
      "description": "Y좌표에 따른 자동 레이어 정렬",
      "blocks": [
        "// 여러 캐릭터 오브젝트",
        "when_run_button_click",
        "repeat_while_true",
        "  // Y좌표 기준 정렬",
        "  set_variable('내Y좌표', <coordinate_object('y')>)",
        "  ",
        "  // 다른 오브젝트와 비교",
        "  foreach_object('모든캐릭터', 'other')",
        "    if_condition(<get_variable('내Y좌표') > <get_object_y('other')>>)",
        "      // 내가 더 위에 있으면 뒤로",
        "      change_object_index(-1)",
        "    else",
        "      // 내가 더 아래 있으면 앞으로",
        "      change_object_index(1)",
        "  ",
        "  wait_second(0.1)",
        "",
        "// 이동 시 레이어 자동 조정",
        "when_dragging",
        "// 드래그 중에는 맨 앞으로",
        "repeat_basic(20)",
        "  change_object_index(1)",
        "",
        "when_drag_end",
        "// 드래그 끝나면 Y좌표에 맞게 재정렬",
        "broadcast_message('레이어정렬')"
      ],
      "explanation": "Y좌표를 기준으로 오브젝트들을 자동으로 정렬하여 원근감을 표현합니다."
    }
  ],

  "progressive_hints": [
    {
      "situation": "오브젝트를 앞이나 뒤로 이동시키고 싶어요",
      "steps": [
        {
          "step": 1,
          "hint_type": "category",
          "content": "'생김새' 카테고리에서 순서 관련 블록을 찾아보세요"
        },
        {
          "step": 2,
          "hint_type": "specific_block",
          "content": "'오브젝트 순서 바꾸기' 블록을 사용하세요"
        },
        {
          "step": 3,
          "hint_type": "concept",
          "content": "양수는 앞으로, 음수는 뒤로 이동해요"
        }
      ]
    },
    {
      "situation": "여러 단계씩 순서를 변경하고 싶어요",
      "steps": [
        {
          "step": 1,
          "hint_type": "concept",
          "content": "큰 숫자를 입력하면 여러 단계 이동해요"
        },
        {
          "step": 2,
          "hint_type": "specific_block",
          "content": "change_object_index(5)는 5단계 앞으로 이동"
        },
        {
          "step": 3,
          "hint_type": "category",
          "content": "반복문과 함께 사용하면 점진적 이동도 가능해요"
        }
      ]
    },
    {
      "situation": "동적으로 순서를 조정하고 싶어요",
      "steps": [
        {
          "step": 1,
          "hint_type": "concept",
          "content": "변수나 계산 결과를 순서 변경 값으로 사용할 수 있어요"
        },
        {
          "step": 2,
          "hint_type": "category",
          "content": "조건문으로 상황에 따라 다른 값을 적용하세요"
        },
        {
          "step": 3,
          "hint_type": "specific_block",
          "content": "change_object_index(<random_number(-3, 3)>)로 무작위 변경도 가능해요"
        }
      ]
    }
  ],

  "common_mistakes": [
    {
      "mistake": "순서가 변하지 않음",
      "why_it_happens": "이미 최상위/최하위에 있는 상태",
      "consequence": "더 이상 이동할 수 없음",
      "solution": "현재 위치 확인 후 조정",
      "teaching_moment": "오브젝트 순서는 한계가 있어요. 맨 앞이나 뒤에서는 더 갈 수 없어요."
    },
    {
      "mistake": "다른 오브젝트가 영향받음",
      "why_it_happens": "레이어 시스템의 상대성을 이해하지 못함",
      "consequence": "예상과 다른 겹침 순서",
      "solution": "전체 오브젝트 순서 관계 파악",
      "teaching_moment": "한 오브젝트가 이동하면 다른 것들과의 관계가 바뀌어요."
    },
    {
      "mistake": "너무 큰 값 사용",
      "why_it_happens": "극단적으로 이동시키려 함",
      "consequence": "불필요한 연산",
      "solution": "적절한 범위의 값 사용",
      "teaching_moment": "보통 -10~10 정도면 충분해요. 너무 큰 값은 의미가 없어요."
    },
    {
      "mistake": "순서 변경이 누적됨",
      "why_it_happens": "반복적으로 같은 방향으로만 이동",
      "consequence": "의도하지 않은 극단적 위치",
      "solution": "양방향 이동이나 리셋 추가",
      "teaching_moment": "계속 앞으로만 가면 결국 맨 앞에 고정돼요."
    }
  ],

  "step_by_step_guide": [
    {
      "step": 1,
      "title": "생김새 카테고리 열기",
      "instruction": "블록 팔레트에서 보라색 '생김새' 카테고리를 클릭하세요.",
      "visual_hint": "붓 아이콘이 있는 카테고리입니다."
    },
    {
      "step": 2,
      "title": "순서 변경 블록 선택",
      "instruction": "'오브젝트 순서 바꾸기' 블록을 찾아 드래그하세요.",
      "visual_hint": "숫자 입력란이 있는 블록입니다."
    },
    {
      "step": 3,
      "title": "이동 방향과 거리 설정",
      "instruction": "양수(앞으로) 또는 음수(뒤로) 값을 입력하세요.",
      "visual_hint": "1~5 정도가 적당합니다."
    },
    {
      "step": 4,
      "title": "이벤트와 연결",
      "instruction": "언제 순서를 변경할지 이벤트 블록과 연결하세요.",
      "visual_hint": "클릭, 키 입력, 메시지 등과 연결합니다."
    },
    {
      "step": 5,
      "title": "테스트 및 조정",
      "instruction": "실행하여 오브젝트 순서가 올바르게 변경되는지 확인하세요.",
      "visual_hint": "다른 오브젝트와의 겹침을 확인합니다."
    }
  ],

  "related_blocks": [
    {
      "block_id": "go_to_front",
      "relationship": "최상위로",
      "explanation": "오브젝트를 맨 앞으로 이동"
    },
    {
      "block_id": "go_to_back",
      "relationship": "최하위로",
      "explanation": "오브젝트를 맨 뒤로 이동"
    },
    {
      "block_id": "set_object_order",
      "relationship": "절대 위치",
      "explanation": "특정 순서로 직접 설정"
    },
    {
      "block_id": "get_object_order",
      "relationship": "순서 확인",
      "explanation": "현재 레이어 순서 확인"
    },
    {
      "block_id": "clone_self",
      "relationship": "복제 생성",
      "explanation": "복제본도 레이어 순서 관리 필요"
    },
    {
      "block_id": "show/hide",
      "relationship": "표시 제어",
      "explanation": "숨김/표시와 레이어 관리 조합"
    }
  ],

  "debugging_tips": [
    {
      "problem": "순서 변경이 안 보여요",
      "possible_causes": ["오브젝트가 하나뿐", "모두 같은 위치에 있음", "투명하거나 숨겨진 상태"],
      "solutions": ["여러 오브젝트 추가", "오브젝트 위치 조정", "show() 확인"]
    },
    {
      "problem": "예상과 다른 순서로 표시돼요",
      "possible_causes": ["다른 오브젝트도 순서 변경 중", "복제본 순서 충돌", "초기 순서 설정 오류"],
      "solutions": ["각 오브젝트별 순서 확인", "복제본 레이어 관리", "초기화 코드 추가"]
    },
    {
      "problem": "순서가 계속 바뀌어요",
      "possible_causes": ["반복문에서 계속 실행", "여러 이벤트 충돌", "조건 없이 실행"],
      "solutions": ["실행 조건 추가", "플래그 변수 사용", "이벤트 정리"]
    }
  ],

  "real_world_connections": [
    {
      "analogy": "책상 위 종이",
      "explanation": "여러 종이를 겹쳐놓고 순서를 바꾸는 것과 같습니다."
    },
    {
      "analogy": "포토샵 레이어",
      "explanation": "그래픽 프로그램의 레이어를 위아래로 이동시키는 것과 동일합니다."
    },
    {
      "analogy": "카드 덱",
      "explanation": "카드 묶음에서 특정 카드를 위아래로 옮기는 것과 비슷합니다."
    },
    {
      "analogy": "창문 겹치기",
      "explanation": "컴퓨터에서 여러 창을 앞뒤로 배치하는 것과 같은 개념입니다."
    }
  ],

  "extensions_and_variations": [
    {
      "concept": "깊이 정렬 알고리즘",
      "description": "Y좌표나 크기 기반 자동 정렬",
      "use_case": "아이소메트릭 게임, 3D 효과, 원근법 표현"
    },
    {
      "concept": "레이어 그룹 관리",
      "description": "관련 오브젝트들을 그룹으로 묶어 관리",
      "use_case": "UI 시스템, 배경/전경 분리, 씬 관리"
    },
    {
      "concept": "동적 z-index",
      "description": "상황에 따라 실시간으로 레이어 재배치",
      "use_case": "인터랙티브 씬, 충돌 처리, 포커스 시스템"
    },
    {
      "concept": "레이어 애니메이션",
      "description": "순서 변경을 애니메이션화",
      "use_case": "카드 셔플, 페이지 전환, 3D 회전"
    }
  ],

  "assessment_criteria": [
    {
      "level": "기초",
      "criteria": "change_object_index로 간단한 순서 변경을 할 수 있다",
      "example": "앞으로/뒤로 이동, 클릭 시 최상위"
    },
    {
      "level": "중급",
      "criteria": "조건과 반복을 활용한 동적 레이어 관리를 구현할 수 있다",
      "example": "Y좌표 정렬, 크기별 배치, UI 레이어 관리"
    },
    {
      "level": "고급",
      "criteria": "복잡한 레이어 시스템과 3D 효과를 구현할 수 있다",
      "example": "깊이 정렬 시스템, 아이소메트릭 뷰, 동적 z-index"
    }
  ]
}
